---
import MobileMenuFooter from 'virtual:starlight/components/MobileMenuFooter';
import SidebarPersister from '@astrojs/starlight/components/SidebarPersister.astro';
import SidebarSublist from '@astrojs/starlight/components/SidebarSublist.astro';

const { sidebar } = Astro.locals.starlightRoute;
---

<SidebarPersister>
	<SidebarSublist sublist={sidebar} nested={false} />
</SidebarPersister>

<div class="md:sl-hidden">
	<MobileMenuFooter />
</div>

<script>
	// Force all sidebar details elements to be open
	document.addEventListener('DOMContentLoaded', () => {
		const sidebarDetails = document.querySelectorAll('nav.sidebar details, .sidebar-content details, #starlight__sidebar details');
		sidebarDetails.forEach(details => {
			details.setAttribute('open', '');
		});
	});

	// Also run immediately in case DOMContentLoaded already fired
	const sidebarDetails = document.querySelectorAll('nav.sidebar details, .sidebar-content details, #starlight__sidebar details');
	sidebarDetails.forEach(details => {
		details.setAttribute('open', '');
	});
</script>
